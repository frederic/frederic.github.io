
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://fredericb.info/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://fredericb.info/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://fredericb.info/theme/font-awesome/css/font-awesome.min.css">


    <link href="https://fredericb.info/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="fred's notes Atom">


    <link rel="shortcut icon" href="/resources/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/resources/favicon.ico" type="image/x-icon">


  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />


    <meta name="author" content="Frédéric" />
    <meta name="description" content="Frédéric's Thoughts and Writings" />
<meta property="og:site_name" content="fred's notes"/>
<meta property="og:type" content="blog"/>
<meta property="og:title" content="fred's notes"/>
<meta property="og:description" content="Frédéric's Thoughts and Writings"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://fredericb.info"/>
<meta property="og:image" content="/resources/sitelogo.jpg">

  <title>fred's notes &ndash;     Tag arm
</title>

</head>
<body>
  <aside>
    <div>
      <a href="/">
        <img src="/resources/sitelogo.jpg" alt="fred's notes" title="fred's notes">
      </a>
      <h1><a href="/">fred's notes</a></h1>

<p>Security & Stuff</p>
      <nav>
        <ul class="list">
          <li><a href="https://fredericb.info/category/advisory.html">Advisory</a></li>
          <li><a href="https://fredericb.info/category/article.html">Article</a></li>
          <li><a href="https://fredericb.info/category/tool.html">Tool</a></li>
          <li><a href="https://fredericb.info/pages/contact.html#contact">Contact</a></li>

        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-github" href="https://github.com/frederic" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/fredericbasse" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-rss" href="/feeds/all.atom.xml" target="_blank"><i class="fa fa-rss"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://fredericb.info/">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://fredericb.info/feeds/all.atom.xml">    Atom
</a>

    </nav>



<article>
  <header>
    <h2><a href="https://fredericb.info/2021/11/booting-ubuntu-on-google-chromecast-with-google-tv.html#booting-ubuntu-on-google-chromecast-with-google-tv">Booting Ubuntu on Google Chromecast With Google TV</a></h2>
    <p>
          Posted on Mon 29 November 2021 in <a href="https://fredericb.info/category/article.html">Article</a>


          &#8226;     Tagged with

              <a href="https://fredericb.info/tag/arm.html">arm</a>,              <a href="https://fredericb.info/tag/amlogic.html">amlogic</a>,              <a href="https://fredericb.info/tag/bootloader.html">bootloader</a>,              <a href="https://fredericb.info/tag/bootrom.html">bootrom</a>,              <a href="https://fredericb.info/tag/chromecast.html">chromecast</a>,              <a href="https://fredericb.info/tag/uboot.html">uboot</a>,              <a href="https://fredericb.info/tag/ubuntu.html">ubuntu</a>,              <a href="https://fredericb.info/tag/usb.html">usb</a>
    </p>
  </header>
  <div>
      <p>In a previous post, we detailed <a href="https://fredericb.info/2021/02/amlogic-usbdl-unsigned-code-loader-for-amlogic-bootrom.html">a vulnerability in the Amlogic System-On-Chip bootROM</a> that allows arbitrary code execution at EL3.
Since the <a href="https://store.google.com/us/product/chromecast_google_tv">Chromecast with Google TV</a> (CCwGTV) is one of the devices affected by this issue, it opens the possibility to run a custom OS like Ubuntu.</p>
<p>This post describes …</p>
      <br>
      <a class="btn" href="https://fredericb.info/2021/11/booting-ubuntu-on-google-chromecast-with-google-tv.html#booting-ubuntu-on-google-chromecast-with-google-tv">    Continue reading
</a>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://fredericb.info/2021/02/amlogic-usbdl-unsigned-code-loader-for-amlogic-bootrom.html#amlogic-usbdl-unsigned-code-loader-for-amlogic-bootrom">amlogic-usbdl : unsigned code loader for Amlogic BootROM</a></h2>
    <p>
          Posted on Wed 10 February 2021 in <a href="https://fredericb.info/category/tool.html">Tool</a>


          &#8226;     Tagged with

              <a href="https://fredericb.info/tag/arm.html">arm</a>,              <a href="https://fredericb.info/tag/amlogic.html">amlogic</a>,              <a href="https://fredericb.info/tag/chromecast.html">chromecast</a>,              <a href="https://fredericb.info/tag/bootrom.html">bootrom</a>,              <a href="https://fredericb.info/tag/usb.html">usb</a>,              <a href="https://fredericb.info/tag/exploit.html">exploit</a>
    </p>
  </header>
  <div>
      <p>In previous posts, we explained how to <a href="https://fredericb.info/2020/06/reverse-engineer-usb-stack-of-exynos-bootrom.html">reverse the USB stack in the Exynos bootROM</a>, which led to the <a href="https://fredericb.info/2020/06/exynos-usbdl-unsigned-code-loader-for-exynos-bootrom.html">discovery of a critical bug</a>.
After reproducing this methodology on <a href="https://fredericb.info/2021/02/dump-amlogic-s905d3-bootrom-from-khadas-vim3l-board.html">Amlogic bootROM recently dumped</a>, a similar vulnerability has been discovered in the USB stack that can be exploited to run arbitrary …</p>
      <br>
      <a class="btn" href="https://fredericb.info/2021/02/amlogic-usbdl-unsigned-code-loader-for-amlogic-bootrom.html#amlogic-usbdl-unsigned-code-loader-for-amlogic-bootrom">    Continue reading
</a>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://fredericb.info/2021/02/dump-amlogic-s905d3-bootrom-from-khadas-vim3l-board.html#dump-amlogic-s905d3-bootrom-from-khadas-vim3l-board">Dump Amlogic S905D3 BootROM from Khadas VIM3L board</a></h2>
    <p>
          Posted on Tue 09 February 2021 in <a href="https://fredericb.info/category/article.html">Article</a>


          &#8226;     Tagged with

              <a href="https://fredericb.info/tag/arm.html">arm</a>,              <a href="https://fredericb.info/tag/amlogic.html">amlogic</a>,              <a href="https://fredericb.info/tag/bootloader.html">bootloader</a>,              <a href="https://fredericb.info/tag/bootrom.html">bootrom</a>,              <a href="https://fredericb.info/tag/khadas.html">khadas</a>,              <a href="https://fredericb.info/tag/vim3l.html">vim3l</a>
    </p>
  </header>
  <div>
      <p>This post describes how to dump bootROM from <a href="https://www.amlogic.com/#Products/392/index.html">Amlogic S905D3 SoC</a> using <a href="https://www.khadas.com/vim3l">Khadas VIM3L board</a>.
Since this board doesn't use Secure Boot, we can execute custom code in Secure World (a.k.a TrustZone) without exploiting any vulnerability.
In addition, the board exposes an UART connector, which is convenient for …</p>
      <br>
      <a class="btn" href="https://fredericb.info/2021/02/dump-amlogic-s905d3-bootrom-from-khadas-vim3l-board.html#dump-amlogic-s905d3-bootrom-from-khadas-vim3l-board">    Continue reading
</a>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://fredericb.info/2020/12/sve-2019-13963-remote-stack-overflow-in-samsung-baseband-caused-by-malformed-immediate-assignment-message.html#sve-2019-13963-remote-stack-overflow-in-samsung-baseband-caused-by-malformed-immediate-assignment-message">SVE-2019-13963 : Remote stack overflow in Samsung baseband caused by malformed IMMEDIATE ASSIGNMENT message</a></h2>
    <p>
          Posted on Mon 07 December 2020 in <a href="https://fredericb.info/category/advisory.html">Advisory</a>


          &#8226;     Tagged with

              <a href="https://fredericb.info/tag/vulnerability.html">vulnerability</a>,              <a href="https://fredericb.info/tag/advisory.html">advisory</a>,              <a href="https://fredericb.info/tag/samsung.html">samsung</a>,              <a href="https://fredericb.info/tag/shannon.html">shannon</a>,              <a href="https://fredericb.info/tag/baseband.html">baseband</a>,              <a href="https://fredericb.info/tag/security.html">security</a>,              <a href="https://fredericb.info/tag/arm.html">arm</a>
    </p>
  </header>
  <div>
      <h1>Description</h1>
<p>When Samsung Shannon baseband receives message IMMEDIATE ASSIGNMENT (9.1.18 in <a href="https://www.etsi.org/deliver/etsi_gts/04/0408/05.03.00_60/gsmts_0408v050300p.pdf">GSM/04.08</a>) from network, the length of the Mobile Allocation IE (GSM/04.08 10.5.2.21) is not properly checked.</p>
<p><img alt="GSM/04.08 IMMEDIATE ASSIGNMENT message" src="https://fredericb.info/blog/SVE-2019-13963/gsm_imm-assign.png" width="700px"></p>
<p>Mobile allocation data is directly copied to a buffer on the stack without checking …</p>
      <br>
      <a class="btn" href="https://fredericb.info/2020/12/sve-2019-13963-remote-stack-overflow-in-samsung-baseband-caused-by-malformed-immediate-assignment-message.html#sve-2019-13963-remote-stack-overflow-in-samsung-baseband-caused-by-malformed-immediate-assignment-message">    Continue reading
</a>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://fredericb.info/2020/11/remote-stack-overflow-in-samsung-baseband-caused-by-malformed-gmm-attach-accept-message.html#remote-stack-overflow-in-samsung-baseband-caused-by-malformed-gmm-attach-accept-message">Remote stack overflow in Samsung baseband caused by malformed GMM ATTACH ACCEPT message</a></h2>
    <p>
          Posted on Mon 30 November 2020 in <a href="https://fredericb.info/category/advisory.html">Advisory</a>


          &#8226;     Tagged with

              <a href="https://fredericb.info/tag/vulnerability.html">vulnerability</a>,              <a href="https://fredericb.info/tag/advisory.html">advisory</a>,              <a href="https://fredericb.info/tag/samsung.html">samsung</a>,              <a href="https://fredericb.info/tag/shannon.html">shannon</a>,              <a href="https://fredericb.info/tag/baseband.html">baseband</a>,              <a href="https://fredericb.info/tag/security.html">security</a>,              <a href="https://fredericb.info/tag/arm.html">arm</a>
    </p>
  </header>
  <div>
      <h1>Description</h1>
<p>When Samsung Shannon baseband receives message GMM ATTACH ACCEPT (9.4.2 in <a href="https://www.etsi.org/deliver/etsi_ts/124000_124099/124008/14.04.00_60/ts_124008v140400p.pdf">TS 24.008</a>) from network,
the minimum length for MS Identity IE (10.5.1.4) is not properly checked.</p>
<p><img alt="TS 24.008 GMM ATTACH ACCEPT message" src="https://fredericb.info/blog/Shannon_MS_ID/gmm_attach_accept.png" width="700px"></p>
<p>MS Identity (IEI 0x23) length is decremented without prior check. If this value is zero, a …</p>
      <br>
      <a class="btn" href="https://fredericb.info/2020/11/remote-stack-overflow-in-samsung-baseband-caused-by-malformed-gmm-attach-accept-message.html#remote-stack-overflow-in-samsung-baseband-caused-by-malformed-gmm-attach-accept-message">    Continue reading
</a>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://fredericb.info/2020/11/remote-stack-overflow-in-samsung-baseband-caused-by-malformed-p-tmsi-reallocation-command.html#remote-stack-overflow-in-samsung-baseband-caused-by-malformed-p-tmsi-reallocation-command">Remote stack overflow in Samsung baseband caused by malformed P-TMSI REALLOCATION COMMAND</a></h2>
    <p>
          Posted on Mon 23 November 2020 in <a href="https://fredericb.info/category/advisory.html">Advisory</a>


          &#8226;     Tagged with

              <a href="https://fredericb.info/tag/vulnerability.html">vulnerability</a>,              <a href="https://fredericb.info/tag/advisory.html">advisory</a>,              <a href="https://fredericb.info/tag/samsung.html">samsung</a>,              <a href="https://fredericb.info/tag/shannon.html">shannon</a>,              <a href="https://fredericb.info/tag/baseband.html">baseband</a>,              <a href="https://fredericb.info/tag/security.html">security</a>,              <a href="https://fredericb.info/tag/arm.html">arm</a>
    </p>
  </header>
  <div>
      <h1>Description</h1>
<p>When Samsung Shannon baseband receives message P-TMSI REALLOCATION COMMAND (9.4.7 in <a href="https://www.etsi.org/deliver/etsi_ts/124000_124099/124008/13.07.00_60/ts_124008v130700p.pdf">TS 24.008</a>) from network,
the length of the Mobile Identity IE (10.5.1.4) is not properly checked.</p>
<p><img alt="TS 24.008 P-TMSI REALLOCATION COMMAND message" src="https://fredericb.info/blog/PTMSI/TS24.008_PTMSI-realloc-cmd.png" width="700px"></p>
<p>Mobile identity data is directly copied to a stack buffer without prior size check. This stack …</p>
      <br>
      <a class="btn" href="https://fredericb.info/2020/11/remote-stack-overflow-in-samsung-baseband-caused-by-malformed-p-tmsi-reallocation-command.html#remote-stack-overflow-in-samsung-baseband-caused-by-malformed-p-tmsi-reallocation-command">    Continue reading
</a>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://fredericb.info/2020/06/exynos-usbdl-unsigned-code-loader-for-exynos-bootrom.html#exynos-usbdl-unsigned-code-loader-for-exynos-bootrom">exynos-usbdl : unsigned code loader for Exynos BootROM</a></h2>
    <p>
          Posted on Wed 17 June 2020 in <a href="https://fredericb.info/category/tool.html">Tool</a>


          &#8226;     Tagged with

              <a href="https://fredericb.info/tag/arm.html">arm</a>,              <a href="https://fredericb.info/tag/exynos.html">exynos</a>,              <a href="https://fredericb.info/tag/samsung.html">samsung</a>,              <a href="https://fredericb.info/tag/bootrom.html">bootrom</a>,              <a href="https://fredericb.info/tag/usb.html">usb</a>,              <a href="https://fredericb.info/tag/exploit.html">exploit</a>
    </p>
  </header>
  <div>
      <p>In previous posts, we explained how to <a href="https://fredericb.info/2020/06/exynos8890-bootrom-dump-dump-exynos-8890-bootrom-from-samsung-galaxy-s7.html">dump Exynos bootROM</a> and <a href="https://fredericb.info/2020/06/reverse-engineer-usb-stack-of-exynos-bootrom.html">reverse its USB stack</a>.</p>
<p>These efforts led to the discovery of a bug in the USB stack that can be exploited to run arbitrary code.</p>
<p>The following chipsets are known to be affected by this bug :</p>
<ul>
<li>Exynos 8890</li>
<li>Exynos …</li></ul>
      <br>
      <a class="btn" href="https://fredericb.info/2020/06/exynos-usbdl-unsigned-code-loader-for-exynos-bootrom.html#exynos-usbdl-unsigned-code-loader-for-exynos-bootrom">    Continue reading
</a>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://fredericb.info/2020/06/reverse-engineer-usb-stack-of-exynos-bootrom.html#reverse-engineer-usb-stack-of-exynos-bootrom">Reverse engineer USB stack of Exynos BootROM</a></h2>
    <p>
          Posted on Tue 16 June 2020 in <a href="https://fredericb.info/category/article.html">Article</a>


          &#8226;     Tagged with

              <a href="https://fredericb.info/tag/arm.html">arm</a>,              <a href="https://fredericb.info/tag/exynos.html">exynos</a>,              <a href="https://fredericb.info/tag/samsung.html">samsung</a>,              <a href="https://fredericb.info/tag/bootrom.html">bootrom</a>,              <a href="https://fredericb.info/tag/usb.html">usb</a>,              <a href="https://fredericb.info/tag/reverse.html">reverse</a>,              <a href="https://fredericb.info/tag/ghidra.html">ghidra</a>
    </p>
  </header>
  <div>
      <p>In the previous post, we explained how to <a href="https://fredericb.info/2020/06/exynos8890-bootrom-dump-dump-exynos-8890-bootrom-from-samsung-galaxy-s7.html">dump Exynos bootROM</a>.</p>
<p>Exynos (8895 in this post) bootROM contains a minimal USB stack to load a signed bootloader from an USB host (a.k.a. boot from USB). 
This post summarizes how this USB stack can be reversed using the Great …</p>
      <br>
      <a class="btn" href="https://fredericb.info/2020/06/reverse-engineer-usb-stack-of-exynos-bootrom.html#reverse-engineer-usb-stack-of-exynos-bootrom">    Continue reading
</a>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://fredericb.info/2020/06/exynos8890-bootrom-dump-dump-exynos-8890-bootrom-from-samsung-galaxy-s7.html#exynos8890-bootrom-dump-dump-exynos-8890-bootrom-from-samsung-galaxy-s7">exynos8890-bootrom-dump : dump Exynos 8890 bootROM from Samsung Galaxy S7</a></h2>
    <p>
          Posted on Mon 15 June 2020 in <a href="https://fredericb.info/category/tool.html">Tool</a>


          &#8226;     Tagged with

              <a href="https://fredericb.info/tag/arm.html">arm</a>,              <a href="https://fredericb.info/tag/exynos.html">exynos</a>,              <a href="https://fredericb.info/tag/samsung.html">samsung</a>,              <a href="https://fredericb.info/tag/bootrom.html">bootrom</a>,              <a href="https://fredericb.info/tag/trustzone.html">trustzone</a>,              <a href="https://fredericb.info/tag/exploit.html">exploit</a>
    </p>
  </header>
  <div>
      <p>This post introduces a tool to dump Samsung Galaxy S7 bootROM using known and fixed security vulnerabilities in Trustzone.</p>
<p>The source code is <a href="https://github.com/frederic/exynos8890-bootrom-dump">available on GitHub</a>.</p>
<p><img alt="Collect bootroms" src="https://fredericb.info/blog/exy-bootrom/Collect_bootroms.png" width="800px"></p>
<h1>Procedure</h1>
<p>We use a Galaxy S7 phone, with ADB access and root privileges.</p>
<p>BootROM code is at address 0x0, in Secure world.
The TEE …</p>
      <br>
      <a class="btn" href="https://fredericb.info/2020/06/exynos8890-bootrom-dump-dump-exynos-8890-bootrom-from-samsung-galaxy-s7.html#exynos8890-bootrom-dump-dump-exynos-8890-bootrom-from-samsung-galaxy-s7">    Continue reading
</a>
  </div>
  <hr />
</article>
<article>
  <header>
    <h2><a href="https://fredericb.info/2018/03/emulating-exynos-4210-bootrom-in-qemu.html#emulating-exynos-4210-bootrom-in-qemu">Emulating Exynos 4210 BootROM in QEMU</a></h2>
    <p>
          Posted on Wed 07 March 2018 in <a href="https://fredericb.info/category/article.html">Article</a>


          &#8226;     Tagged with

              <a href="https://fredericb.info/tag/arm.html">arm</a>,              <a href="https://fredericb.info/tag/exynos.html">exynos</a>,              <a href="https://fredericb.info/tag/samsung.html">samsung</a>,              <a href="https://fredericb.info/tag/bootrom.html">bootrom</a>,              <a href="https://fredericb.info/tag/qemu.html">qemu</a>,              <a href="https://fredericb.info/tag/emulation.html">emulation</a>,              <a href="https://fredericb.info/tag/bootloader.html">bootloader</a>,              <a href="https://fredericb.info/tag/secureboot.html">secureboot</a>
    </p>
  </header>
  <div>
      <p><a href="https://www.qemu.org/">QEMU</a> has support for the SMDKC210 machine, an ARM board based on Exynos 4210 SoC.
Peripherals implemented in QEMU for this machine are <a href="https://git.qemu.org/?p=qemu.git;a=blob;f=hw/char/exynos4210_uart.c">UART</a>, <a href="https://git.qemu.org/?p=qemu.git;a=blob;f=hw/sd/sdhci.c">SDHCI</a>, <a href="https://git.qemu.org/?p=qemu.git;a=blob;f=hw/display/exynos4210_fimd.c">FIMD</a>, <a href="https://git.qemu.org/?p=qemu.git;a=blob;f=hw/i2c/exynos4210_i2c.c">I2C</a>, <a href="https://git.qemu.org/?p=qemu.git;a=blob;f=hw/intc/exynos4210_combiner.c">Interrupt Combiner</a>, <a href="https://git.qemu.org/?p=qemu.git;a=blob;f=hw/intc/exynos4210_gic.c">GIC</a>, <a href="https://git.qemu.org/?p=qemu.git;a=blob;f=hw/misc/exynos4210_clk.c">Clock</a>, <a href="https://git.qemu.org/?p=qemu.git;a=blob;f=hw/misc/exynos4210_pmu.c">PMU</a>, <a href="https://git.qemu.org/?p=qemu.git;a=blob;f=hw/misc/exynos4210_rng.c">RNG</a>, <a href="https://git.qemu.org/?p=qemu.git;a=blob;f=hw/timer/exynos4210_mct.c">MCT</a>, <a href="https://git.qemu.org/?p=qemu.git;a=blob;f=hw/timer/exynos4210_pwm.c">PWM</a>, <a href="https://git.qemu.org/?p=qemu.git;a=blob;f=hw/timer/exynos4210_rtc.c">RTC</a>.</p>
<p><a href="https://www.gsmarena.com/samsung_i9100_galaxy_s_ii-3621.php">Samsung Galaxy S2</a> phone is also based on Exynos 4210, so it should be …</p>
      <br>
      <a class="btn" href="https://fredericb.info/2018/03/emulating-exynos-4210-bootrom-in-qemu.html#emulating-exynos-4210-bootrom-in-qemu">    Continue reading
</a>
  </div>
</article>

  <div class="pagination">
    <a class="btn float-left" href="https://fredericb.info/tag/arm2.html">
      <i class="fa fa-angle-left"></i>     Older Posts

    </a>
  </div>




    <footer>
<p>
  &copy;   - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - Theme <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
         src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " fred's notes ",
  "url" : "https://fredericb.info",
  "image": "/resources/sitelogo.jpg",
  "description": "Frédéric's Thoughts and Writings"
}
</script>

</body>
</html>